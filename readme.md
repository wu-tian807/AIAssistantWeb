# AI 聊天应用 - 说明文档

## 简介
本项目是一个人工智能驱动的聊天应用，为用户提供流畅的AI助手交互体验。系统集成了实时对话存储、动态响应生成和代码块高亮等功能。它支持多个对话，用户可以轻松创建、删除和切换不同的对话。此外，它还集成了Markdown渲染和数学符号（LaTeX）支持，为代码和技术讨论提供增强支持。

## 最新更新
### 核心功能更新
- **模型支持扩展**
  - ✅ 全面更新GPT系列模型支持
  - ✅ 增加推理模型支持（包括O1等新一代推理模型）
  - ✅ 优化多模型切换体验
  - ✅ 智能模型参数配置系统

- **UI/UX 全面优化**
  - ✅ 全面适配移动端设备
  - ✅ 响应式布局重构
  - ✅ 触摸操作优化
  - ✅ 移动端手势支持
  
- **渲染系统升级**
  - ✅ 更高效的Markdown渲染引擎
  - ✅ 优化代码块渲染与高亮
  - ✅ 增强数学公式渲染能力
  - ✅ 图片与多媒体渲染优化

- **Base64 存储优化**
  - 从数据库直接存储 base64 改为存储 base64_id
  - 实际的 base64 数据保存在本地文件系统
  - 显著减少数据库负担
  - 优化查询性能

### 未来展望
- **模型支持扩展**
  - Claude系列模型集成
  - 混合思考模型支持
  - Claude 3.7核心能力
  - 跨模型统一接口

- **文档处理能力**
  - 文本深度理解与分析
  - 文档思考与处理能力
  - PDF、Word等格式直接支持
  - 大型文档分析与摘要

- **架构重构与优化**
  - 更高效的存储系统
  - 分布式部署支持
  - API服务化重构
  - 客户端性能优化

## 项目结构
```
.
├── routes                                    # 路由目录,处理所有HTTP请求
│   ├── image                                # 图片处理相关路由
│   └── user                                 # 用户相关路由,如登录注册等
├── static                                   # 静态资源目录
│   ├── css                                  # CSS样式文件
│   ├── icons                               # 图标资源目录
│   │   ├── models                          # AI模型图标
│   │   └── users                           # 用户头像
│   ├── images                              # 图片资源
│   └── js                                  # JavaScript文件目录
│       ├── utils                           # 工具类JS
├── templates                               # HTML模板目录
└── utils                                   # Python工具类目录
    ├── chat                                # 聊天相关工具
    ├── files                               # 文件处理工具
    ├── ocr                                 # OCR文字识别工具
    └── price                               # 价格计算工具
```

## 核心功能

### 1. 多模型智能聊天
- **丰富的模型支持**
  - GPT系列模型（最新版本）
  - Gemini系列模型
  - DeepseekV3系列
  - O1推理增强模型
  - Grok等开源模型支持

- **智能模型选择**
  - 基于任务自动选择最佳模型
  - 智能参数配置
  - 模型能力检测

- **对话管理**
  - 多对话支持
  - 实时对话存储
  - 智能标题生成
  - 会话版本控制

### 2. 多媒体处理系统
- **图片处理**
  - 支持在聊天消息中上传图片
  - 发送前自动预览图片
  - 智能OCR处理系统
  - AI图像增强识别

- **视频处理**
  - 支持视频文件上传和预览
  - Gemini模型原生视频分析能力
  - 视频内容理解和描述

- **文件处理**
  - 可扩展的附件系统
  - 版本控制集成
  - 智能文件管理

### 3. UI/UX 设计
- **响应式布局**
  - 全面适配PC与移动设备
  - 智能布局切换
  - 触摸操作优化

- **Markdown渲染**
  - 高效的代码高亮
  - 数学公式支持
  - 表格与列表优化

- **用户界面优化**
  - 流畅的动画效果
  - 直观的操作交互
  - 智能状态反馈

### 4. 系统架构
- **后端优化**
  - Redis与本地存储混合架构
  - 抽象化的速率限制器
  - 模块化设计

- **前端模块化**
  - 组件化开发
  - 事件驱动架构
  - 统一状态管理

## 安装
要开始使用这个聊天应用，请按照以下步骤操作：

1. **克隆仓库**：
   ```sh
   git clone https://github.com/your-username/ai-chat-app.git
   cd ai-chat-app
   ```

2. **配置应用**：
   ```sh
   # 复制配置文件模板
   cp config.example.py config.py
   
   # 编辑config.py，填入你的配置
   ```

3. **安装依赖**：
   ```sh
   python -m venv venv
   source venv/bin/activate  # Windows使用 `venv\Scripts\activate`
   pip install -r requirements.txt
   ```

4. **运行应用**：
   ```sh
   flask run
   ```
   现在可以通过 `http://localhost:5000` 访问应用。

## 配置说明
应用使用`config.py`进行配置，主要包含以下配置项：

1. **Flask配置**
   - `SECRET_KEY`: 用于session加密的密钥

2. **数据库配置**
   - `SQLALCHEMY_DATABASE_URI`: 数据库连接URI

3. **API密钥配置**
   - `OPENAI_API_KEY`: OpenAI API密钥
   - `GOOGLE_API_KEY`: Google API密钥
   - `DEEPSEEK_API_KEY`: DeepSeek API密钥

> **注意**: 请不要将包含实际API密钥的config.py文件提交到版本控制系统中。

## 使用的技术
- **前端**：HTML5, CSS3, JavaScript (ES6+)
- **后端**：Python (Flask)
- **AI模型**：GPT系列、Deepseek、Gemini、O1等
- **数据存储**：Redis、关系型数据库、本地文件系统
- **外部库**：markdown-it、highlight.js、KaTeX等

## 使用说明
- **开始对话**：点击"新建聊天"按钮开始新对话。
- **发送消息**：在文本框中输入消息并按"Enter"或点击"发送"。
- **多媒体上传**：点击添加按钮或直接拖拽/粘贴上传文件。
- **管理版本**：使用版本控制按钮在AI响应的不同版本之间导航。
- **系统提示词**：自定义系统提示词以控制AI行为模式。
